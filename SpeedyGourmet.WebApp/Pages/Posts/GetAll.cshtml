@page
@model SpeedyGourmet.WebApp.Pages.Posts.GetAll
@{
}

<h2>List of Comments <i class="fa-regular fa-comments"></i></h2>
<br />

@if (Model.User.IsAdmin == true)
{
    <div class="d-flex">
        <div class="form-group">
            <a class="btn btn-danger" asp-area=" "asp-page="/Posts/GetAllByRecipe">View all posts by recipe <i class="bi bi-arrow-left"></i></a>
        </div>

        <div class="form-group">
            <a class="btn btn-danger mx-2" asp-area=" " asp-page="/Posts/GetAllByUser">View all posts by user <i class="bi bi-arrow-left"></i></a>
        </div>
    </div>
    <br />

    <table class="table">
        <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
        </thead>

        <tbody>
            @foreach (Model.Post post in Model.Posts)
            {
                <tr>
                    <td><i class="fa-solid fa-user"></i> @post.User.UserName Posted on @post.Recipe.Title by @post.Recipe.Author with @post.Rating <i class="fa-regular fa-star"></i>'s</td>
                    <td></td>
                    <td>
                        <a asp-page="/posts/Delete" asp-route-postId="@post.Id"><i class="fa-regular fa-trash-can" style="color: #d10000;"></i></a> /
                        <a asp-page="/posts/GetById" asp-route-postId="@post.Id"><i class="fa-regular fa-eye"></i></a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <br />

    <h2>Create a new Post</h2>

    <form method="post" class="d-grid">
        <div class="d-flex">
            <input hidden type="number" value="@Model.User.Id" name="id_user" />
            @* <div class="form-group">
                <select name="id_user" class="form-control" style="width: 200px;">
                    <option selected>Select User</option>
                    @foreach (Model.User user in Model.Users)
                    {
                        <option value="@user.Id">@user.UserName</option>
                    }
                </select>
            </div> *@

            <div class="form-group mx-2">
            <select name="id_recipe" class="form-control" style="width: 200px;">
                    <option selected>Select Recipe</option>
                    @foreach (Model.Recipe recipe in Model.Recipes)
                    {
                        if(recipe.Author.Id != Model.User.Id)
                        {
                            <option value="@recipe.Id">@recipe.Title</option>
                        }
                    }
                </select>
            </div>

            <div>
                <input type="number" name="rating" id="rating" min="1" max="10" class="form-control mx-2" style="width: 200px;"  placeholder="Enter Rating (1-10)">
            </div>
        </div>
        <br />

        <div>
            <textarea type="text" name="comment" id="comment" class="form-control" placeholder="Enter Post" rows="10" cols="30"></textarea>
        </div>
        <br />

        <div>
            <button type="submit" class="btn btn-primary">Create Post <i class="fa-solid fa-arrow-right"></i></button>
        </div>
    </form>
}